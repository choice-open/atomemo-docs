---
title: 版本控制
description: 学习如何使用版本控制管理工作流的历史版本
---

# 版本控制

版本控制允许你保存工作流的不同状态，在需要时可以查看、对比和恢复到任何历史版本。这对于管理工作流的演进、回滚错误更改、以及团队协作都非常有用。

## 打开版本控制

在画布顶部工具栏找到版本控制按钮：

1. 点击工具栏中的历史图标按钮
2. 版本控制面板在右侧打开
3. 显示所有已保存的版本列表

**快捷键**: 无专用快捷键，需要点击按钮打开。

## 创建版本

### 创建新版本

将当前工作流状态保存为一个新版本：

**步骤**:
1. 打开版本控制面板
2. 点击"创建版本"链接
3. 填写版本信息：
   - **版本名称**（必填）：描述性名称，1-64 个字符
   - **版本描述**（可选）：详细说明，最多 256 个字符
4. 点击"创建版本"按钮
5. 新版本添加到列表顶部

**命名建议**:
```
✓ "添加用户验证功能"
✓ "修复订单计算错误"
✓ "v1.0.0 正式发布"
✓ "优化性能 - 2024-03-15"

✗ "版本1"
✗ "test"
✗ "新版本"
```

**使用场景**:
- 完成重要功能后保存
- 发布到生产环境前创建版本
- 开始大改动前保存当前状态
- 定期保存工作进度

### 空版本列表

如果还没有任何版本：

1. 面板显示空状态提示
2. 点击"创建版本"按钮
3. 创建第一个版本

## 版本列表

### 查看版本列表

版本列表显示所有已保存的版本：

**显示顺序**:
- 最新版本在顶部
- 按创建时间倒序排列
- 使用虚拟滚动优化性能

**版本卡片信息**:
- **版本名称**: 版本的标识名称
- **版本描述**: 详细说明（如果有）
- **创建时间**: 版本创建的日期时间
- **当前标记**: 正在使用的版本显示"当前"标签
- **操作菜单**: 编辑、查看详情、删除

### 版本状态

版本卡片会显示不同的状态：

**当前版本**:
- 显示"当前"标签
- 表示工作流正在使用这个版本
- 工作流未修改时才显示

**预览版本**:
- 正在预览的版本会高亮显示
- 画布显示该版本的内容
- 未应用到工作流

**普通版本**:
- 灰色显示
- 可以点击切换预览

## 预览版本

### 预览某个版本

查看历史版本的内容而不影响当前工作流：

**步骤**:
1. 在版本列表中找到要预览的版本
2. 点击版本卡片
3. 画布自动切换显示该版本的工作流
4. 版本卡片显示为预览状态

**预览特点**:
- 画布显示该版本的节点和连接
- 可以查看节点配置（只读）
- 不能编辑预览的版本
- 未应用到实际工作流

### 查看版本详情

查看版本的完整信息：

1. 点击版本卡片的菜单按钮 (⋯)
2. 选择"查看详情"
3. 显示版本详细信息：
   - 版本名称
   - 完整描述
   - 创建时间
   - 版本 ID
4. 点击"返回"回到版本列表

### 取消预览

返回当前工作流状态：

**方法一：点击取消**
1. 点击面板底部的"取消"按钮
2. 画布恢复到当前工作流状态
3. 预览被取消

**方法二：关闭面板**
1. 点击面板外部区域
2. 或按 Esc 键
3. 自动取消预览

**方法三：预览其他版本**
1. 点击另一个版本卡片
2. 切换到新版本的预览

## 应用版本

### 应用预览的版本

将预览的版本应用到当前工作流：

**步骤**:
1. 预览要应用的版本
2. 点击面板底部的"应用"按钮
3. 系统弹出确认对话框
4. 确认后，预览版本应用到工作流
5. 画布更新为该版本的内容

**重要提示**:
- 应用版本会覆盖当前工作流的所有内容
- 当前未保存的修改将丢失
- 建议应用前先创建当前版本
- 应用后版本控制面板自动关闭

**确认对话框**:
```
确认应用版本 "版本名称" ？

应用此版本将会覆盖当前工作流的所有内容。
建议在应用前先保存当前工作流为新版本。

[取消] [确认应用]
```

### 应用版本前保存

保护当前工作的最佳实践：

1. 在应用其他版本前
2. 先创建当前状态的版本
3. 然后再预览和应用历史版本
4. 如果需要，可以恢复到刚才的状态

**流程示例**:
```
当前工作流 → 创建版本"当前进度" → 预览旧版本 → 应用旧版本
                                      ↓
                              如需恢复 → 应用"当前进度"版本
```

## 编辑版本

### 修改版本信息

更新版本的名称和描述：

**步骤**:
1. 点击版本卡片的菜单按钮 (⋯)
2. 选择"编辑"
3. 修改版本信息：
   - 版本名称（1-64 字符）
   - 版本描述（最多 256 字符）
4. 点击"保存"按钮

**注意事项**:
- 只能修改版本的元信息
- 不能修改版本的工作流内容
- 修改后立即生效

**使用场景**:
- 补充版本说明
- 修正错误的版本名称
- 添加版本详细信息

## 删除版本

### 删除不需要的版本

清理不再需要的历史版本：

**步骤**:
1. 点击版本卡片的菜单按钮 (⋯)
2. 选择"删除"
3. 版本卡片显示确认提示
4. 再次点击确认删除
5. 或点击取消放弃删除

**二次确认机制**:
- 第一次点击"删除"显示确认提示
- 需要再次点击"确认"才会删除
- 点击"取消"或其他区域放弃删除
- 防止误删重要版本

**限制**:
- 不能删除正在预览的版本
- 删除后无法恢复
- 谨慎删除重要版本

## 版本控制面板

### 面板状态

版本控制面板有多个视图状态：

**版本列表视图**:
- 显示所有版本
- 可以预览和应用版本
- 主要操作界面

**创建版本视图**:
- 输入版本名称和描述
- 创建新版本
- 点击返回箭头回到列表

**编辑版本视图**:
- 修改选中版本的信息
- 保存或取消修改
- 点击返回箭头回到列表

**版本详情视图**:
- 显示版本完整信息
- 只读模式
- 点击返回箭头回到列表

**空状态视图**:
- 没有任何版本时显示
- 引导创建第一个版本

### 面板操作

**头部操作**:
- 历史图标 + 标题
- "创建版本"链接（版本列表视图）
- 返回按钮（其他视图）

**底部操作**:
- **版本列表视图**: [取消] [应用]
- **创建版本视图**: [取消] [创建版本]
- **编辑版本视图**: [取消] [保存]
- **版本详情视图**: [返回]

### 键盘操作

**Esc 键**:
- 版本列表/空状态：关闭面板并取消预览
- 创建/编辑/详情视图：返回版本列表
- 多次按 Esc：逐级返回直到关闭面板

## 使用场景

### 场景一：功能开发

**工作流程**:
1. 开始新功能前创建版本"开发前基线"
2. 开发过程中定期创建版本
3. 功能完成后创建版本"新功能完成"
4. 测试发现问题，预览"开发前基线"
5. 应用"开发前基线"回到稳定状态
6. 重新开发新功能

### 场景二：错误恢复

**问题场景**:
1. 修改工作流后出现错误
2. 不确定哪里出了问题
3. 打开版本控制
4. 预览最后一个正常版本
5. 确认该版本没问题
6. 应用该版本恢复工作流

### 场景三：A/B 测试

**测试流程**:
1. 创建版本"方案A"
2. 修改工作流创建版本"方案B"
3. 测试方案B的效果
4. 如果方案A更好，预览并应用"方案A"
5. 如果方案B更好，继续使用当前版本

### 场景四：团队协作

**协作场景**:
1. 成员A创建版本"我的实现"
2. 成员B查看版本列表
3. 预览"我的实现"版本
4. 了解成员A的工作
5. 基于该版本继续改进

## 最佳实践

### 1. 定期创建版本

**建议时机**:
- 每完成一个功能模块
- 每次重要修改前
- 每天工作结束时
- 发布到生产环境前

### 2. 清晰的版本命名

**命名约定**:
```
按功能命名：
✓ "添加支付功能"
✓ "修复数据验证"

按时间命名：
✓ "2024-03-15 备份"
✓ "第三季度版本"

按版本号命名：
✓ "v1.0.0 正式版"
✓ "v1.1.0 新增功能"

按状态命名：
✓ "开发完成待测试"
✓ "生产环境当前版本"
```

### 3. 添加详细描述

**描述内容**:
- 修改了什么功能
- 为什么做这些修改
- 影响哪些节点
- 测试结果如何
- 注意事项

**示例**:
```
版本名称: "优化订单处理流程"

描述:
1. 添加了订单验证节点
2. 优化了库存检查逻辑
3. 修复了金额计算错误
4. 测试通过，可以发布
5. 注意：需要更新环境变量 ORDER_API_KEY
```

### 4. 定期清理旧版本

**清理策略**:
- 删除临时测试版本
- 保留重要里程碑版本
- 保留生产环境版本
- 保留最近 30 天的版本

### 5. 重要操作前备份

**备份时机**:
- 大规模重构前
- 应用他人版本前
- 尝试新功能前
- 修改关键逻辑前

## 常见问题

### Q: 版本保存的是什么内容？

**A**: 版本保存工作流的完整状态，包括：
- 所有节点及其配置
- 节点之间的连接
- 画布布局信息
- 工作流的元数据

不包括：
- 执行历史记录
- 测试数据
- 运行时状态

### Q: 可以创建多少个版本？

**A**: 版本数量没有硬性限制，但建议：
- 定期清理不需要的版本
- 保持版本列表清晰可管理
- 过多版本会影响加载速度

### Q: 预览版本时可以编辑吗？

**A**: 不可以。预览模式是只读的：
- 可以查看节点配置
- 可以浏览工作流结构
- 不能修改任何内容
- 需要先应用版本才能编辑

### Q: 应用版本会影响执行历史吗？

**A**: 不会。应用版本只影响工作流结构：
- 执行历史记录保持不变
- 日志数据不受影响
- 只是工作流配置改变

### Q: 如何比较两个版本的差异？

**A**: 目前需要手动对比：
1. 预览版本A，记录关键配置
2. 预览版本B，查看差异
3. 未来版本会支持自动对比功能

### Q: 删除版本后可以恢复吗？

**A**: 不可以。删除版本是永久性的：
- 删除后无法恢复
- 删除前会二次确认
- 重要版本建议保留

### Q: 版本名称可以重复吗？

**A**: 可以，但不建议：
- 系统允许重复名称
- 通过创建时间区分
- 建议使用唯一的描述性名称

### Q: 切换版本会丢失未保存的修改吗？

**A**: 会的。应用版本前：
1. 系统会提示确认
2. 建议先保存当前修改为新版本
3. 然后再应用其他版本

## 相关资源

- [运行工作流](/zh-hans/guide/workflow/execute-workflow) - 了解如何测试工作流
- [调试工作流](/zh-hans/guide/workflow/debug-workflow) - 学习调试技巧
- [编辑节点](/zh-hans/guide/editing-nodes) - 配置节点参数
